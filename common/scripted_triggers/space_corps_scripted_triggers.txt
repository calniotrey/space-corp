is_space_corp_not_installed = {
	always = no
}

# this = overlord
should_create_space_corp = {
	check_variable = {
		which = years_until_next_corp_creation
		value <= 0
	}
	check_variable = {
		which = number_of_corps
		value < 10
	}
	any_owned_planet = {
		suitable_for_headquarters = yes
	}
}

# this = planet
suitable_for_headquarters = {
	is_colony = yes
	num_pops >= 10
	NOT = {
		has_planet_flag = space_corp_headquarters
	}
}

# this = corp
space_corp_searches_mining_stations = {
	always = yes
}

# this = corp
space_corp_searches_research_stations = {
	always = yes
}

# this = leader
is_scientist_idle = {
	NOR = {
		exists = fleet
		is_researching_area = physics
		is_researching_area = society
		is_researching_area = engineering
	}
}

# this = corp
should_build_science_ship = {
	check_variable = {
		which = space_corp_money
		value >= @science_ship_cost
	}
	count_owned_ship = {
		limit = {
			is_ship_size = science
		}
		count < 5		# TODO change
	}
}

# this = corp
should_destroy_science_ship = {
	count_owned_ship = {
		limit = {
			is_ship_size = science
		}
		count > 5		# TODO change
	}
}

# this = corp
should_build_builder = {
	check_variable = {
		which = space_corp_money
		value >= @builder_cost
	}
	count_owned_ship = {
		limit = {
			is_ship_size = constructor
		}
		count < 1		# TODO change
	}
}

# this = corp
should_destroy_builder = {
	count_owned_ship = {
		limit = {
			is_ship_size = constructor
		}
		count > 5		# TODO change
	}
}

# this = corp
should_start_convoy = {
	NOT = {
		has_country_flag = corp_sent_convoy_recently
	}
	check_variable = {
		which = space_corp_money
		value >= @convoy_min
	}
	any_country = {
		is_country_type = space_corp
		is_suitable_convoy_partner = yes
	}
}

# this = fleet
should_destroy_convoy = {
	NOT = {
		has_fleet_flag = should_not_destroy_convoy
	}
}

# this = target corp
# prev = origin corp
is_suitable_convoy_partner = {
	NOT = {
		is_same_value = prev
	}
	has_communications = prev
	exists = overlord
	NOR = {
		is_hostile = prev
		overlord = {
			is_hostile = prevprev.overlord
		}
		overlord = {
			is_at_war_with = prevprev.overlord
		}
		AND = {
			has_ethic = ethic_spiritualist
			prev.overlord = {
				is_robot_empire = yes
			}
		}
		AND = {
			overlord = {
				is_robot_empire = yes
			}
			prev = {
				has_ethic = ethic_spiritualist
			}
		}
		AND = {
			OR = {
				has_ethic = ethic_xenophobe
				prev = {
					has_ethic = ethic_xenophobe
				}
			}
			NOT = {
				is_same_species = prev
			}
		}
	}
}

# this = planet
is_planet_eligible_for_mining_station = {
	space_corp_has_mining_deposits = yes
	has_mining_station = no
}

# this = planet
is_planet_eligible_for_research_station = {
	space_corp_has_research_deposits = yes
	has_research_station = no
}

# this = system
is_system_eligible_for_mining_station = {
	any_system_planet = {
		is_planet_eligible_for_mining_station = yes
	}
}

# this = system
is_system_eligible_for_research_station = {
	any_system_planet = {
		is_planet_eligible_for_research_station = yes
	}
}

# this = fleet/planet/country
has_close_system_eligible_for_mining_station = {
	any_system = {
		distance = {
			source = prev
			max_jumps = @builder_close_system
			type = hyperlane
			# uses_bypass = no # TODO change?
		}
		is_system_eligible_for_mining_station = yes
	}
}

# this = fleet/planet/country
has_close_system_eligible_for_research_station = {
	any_system = {
		distance = {
			source = prev
			max_jumps = @builder_close_system
			type = hyperlane
			# uses_bypass = no # TODO change?
		}
		is_system_eligible_for_research_station = yes
	}
}
